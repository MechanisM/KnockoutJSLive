if(typeof now!="undefined"){now.updateViewModel=function(model,overwrite){if(viewModel._writeable==true){if(overwrite){for(i in model){ko.setPropMethod(i,model);}}else{var serializedViewModel=ko.toJS(viewModel);var serializedOrigViewModel=JSON.parse(ko._originalSerializedModel);var exclude=[];for(i in serializedViewModel){if(serializedViewModel[i]!=serializedOrigViewModel[i]){exclude.push(i);}}
for(i in model){if(exclude.indexOf(i)=="-1"&&i.indexOf("_")=="-1"){ko.setPropMethod(i,model);}}}}};[].indexOf||(Array.prototype.indexOf=function(v){for(var i=this.length;i--&&this[i]!=v;);return i;});ko.dirtyFlag=function(root,isInitiallyDirty){var result=function(){}
var _initialState=ko.observable(ko.toJSON(root));var _isInitiallyDirty=ko.observable(isInitiallyDirty);result.isDirty=ko.dependentObservable(function(){if(_isInitiallyDirty()){return true;}
var isDirty=_initialState()!==ko.toJSON(root);ko.serializeModel(root);return isDirty;});result.reset=function(){_initialState(ko.toJSON(root));_isInitiallyDirty(false);};return result;};ko.serializeModel=function(root){if(typeof ko._originalSerializedModel=="undefined"){ko._originalSerializedModel=ko.toJSON(root);}};ko.setPropMethod=function(i,model){if(typeof viewModel[i]=="function"){var f=viewModel[i];f(model[i]);}else if(typeof viewModel[i]!="undefined"){viewModel[i]=model[i];}};ko.liveModel=function(model,options){var _def_options={read:true};model._dirtyFlag=ko.dirtyFlag(model);var opt=$.extend(_def_options,options);model._writeable=opt.read;window['viewModel']=model;return model;};ko.save=function(saveOptions){var _def_options={overwrite:false,ignore:[]};var opt=$.extend(_def_options,saveOptions);var model=ko.toJS(viewModel);if(typeof now.modelName!='undefined'){model._modelName=now.modelName;}
if(opt.ignore.length>0){for(i in opt.ignore){delete model[opt.ignore[i]];}}
model._overwrite=opt.overwrite;now.saveViewModel(model);};}else{console.log("Could not find the NowJS scope, please make sure knockoutserver.js is running");}